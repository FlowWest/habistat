<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Model Overview • habistat</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Model Overview">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">habistat</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/model_overview.html">Model Overview</a>
    </li>
    <li>
      <a href="../articles/habitat_training_data.html">Habitat Training Data</a>
    </li>
    <li>
      <a href="../articles/predictor_variables.html">Predictor Variables</a>
    </li>
    <li>
      <a href="../articles/statistical_model.html">Statistical Model Development, Training, and Prediction</a>
    </li>
    <li>
      <a href="../articles/duration_analysis.html">Duration Analysis</a>
    </li>
    <li>
      <a href="../articles/watershed_aggregation.html">Watershed Delineation and Flow Aggregation</a>
    </li>
    <li>
      <a href="../articles/spawning_extents.html">Spawning Extents</a>
    </li>
    <li>
      <a href="../articles/interactive_map.html">Interactive Map User Guide</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="https://flowwest.shinyapps.io/habistat/" class="external-link">Interactive Map</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Model Overview</h1>
                        <h4 data-toc-skip class="author">
<a href="mailto:mrubenson@flowwest.com">Maddee Rubenson</a> &amp; <a href="slewis@flowwest.com">Skyler Lewis</a>
</h4>
            
            <h4 data-toc-skip class="date">2025-02-04</h4>
      

      <div class="hidden name"><code>model_overview.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="rearing-model-overview">Rearing Model Overview<a class="anchor" aria-label="anchor" href="#rearing-model-overview"></a>
</h2>
<p>The modeling method consists of the following fundamental steps:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Predictor variable preparation</strong>: A variety of
hydrologic and geospatial attributes were collected for all stream
reaches within the study area (the Sacramento and San Joaquin river
basins, HUC-4 hydrologic subregions 1802 and 1804). The basis of stream
reach delineation is the ComID reach as defined in <a href="https://nhdplus.com/NHDPlus/NHDPlusV2_home.php" class="external-link">NHDPlusV2</a>.
Attributes include local characteristics like stream gradient,
sinuosity, and depth to bedrock; upstream drainage characteristics like
drainage area size, elevation, mean annual precipitation, and soil
erodibility; and custom modeled confinement measures like topographic
position index (mTPI) and levee confinement. These are discussed further
in the <a href="predictor_variables.html">Predictor Variables</a>
article.</p></li>
<li><p><strong>Hydraulic model training data preparation</strong>: Depth
and velocity outputs from existing two-dimensional hydraulic models were
assembled for “training reaches” within the study area, at a variety of
flows. The depth and velocity raster grids (for HEC-RAS 2D models) or
vector meshes (for SRH-2D models) were divided up based on ComID reach
delineations. A habitat suitability index was applied based on depth and
velocity values (e.g. 1 if a cell is within suitable depth and velocity
range, else 0). Then, habitat suitability was summarized for each reach,
at each flow, into a measure of total suitable habitat area per linear
foot of channel (aka WUA/LF), for each flow. The result is a
flow-to-suitable-area curve for each reach in the training dataset,
normalized by linear feet to be independent of arbitrary reach length.
The habitat suitability process and datasets are discussed further in
the <a href="habitat_training_data.html">Habitat Training Data</a>
article.</p></li>
<li><p><strong>Training statistical model</strong>: The hydraulically
modeled flow-to-suitable-area relationships developed for reaches in
Step 2 are joined to the reach predictor variable table from Step 1.
This dataset (one observation per flow per reach) is then used to train
a statistical model that can be used to predict flow-to-suitable-area
curves for reaches that are not hydraulically modeled. Random Forest
Regression, a decision tree-based machine learning approach, allows for
non-linear relationships between suitable habitat, flow, and the array
of predictor variables. The model development process is detailed in the
<a href="statistical_model.html">Statistical Model</a> article.</p></li>
<li><p><strong>Predicting habitat output</strong>: The trained
statistical model can now be used to predict flow-to-suitable-area
relationships for other streams within the study area. While the
statistical model will produce predictions for any stream with valid
predictor data, the validity and trustworthiness of predictions will
depend on those streams’ similarity to the training dataset. As training
datasets are currently limited to foothill alluvial systems on major
tributary streams, only these should be considered valid. The prediction
process is detailed in the <a href="statistical_model.html">Statistical
Model</a> article, and <em>preliminary</em> flow-to-suitable-habitat
predictions are included in the data package <a href="https://flowwest.shinyapps.io/habistat/" class="external-link">Map App</a>.</p></li>
<li><p><strong>Applying duration criteria</strong>: Suitable habitat
area predictions up to this point are based only on depth and velocity
factors, but inundation duration is also a relevant factor. The
perennially-inundated baseflow channel lacks sufficient food
(invertebrates) for rearing juveniles and should be excluded regardless
of depth and velocity. Meanwhile, channel areas that are inundated for
only short periods of time have reduced habitat benefit as invertebrates
have not had sufficient time to develop. R functions developed for this
project will apply duration-based suitability criteria to an empirically
or statistically derived flow-to-suitable-area curve by inputting (a) a
water year hydrograph and/or (b) a flow threshold that defines the
baseflow channel. These methods are defined in the <a href="duration_analysis.html">Duration Analysis</a> article.</p></li>
<li><p><strong>Filtering to geographic scope</strong>: Rearing
predictions are limited to perennial, natural stream channels of a
certain size. The working draft filter includes reaches of stream order
≥4 (or reaches of stream order ≥3 with drainage area at least 50 km²).
Minor distributaries with a divergence ratio of less than 50% are also
excluded.</p></li>
<li><p><strong>Aggregating from reach to mainstem/watershed
scale:</strong> Reach-scale predictions are aggregated to the scale of
the river (mainstem) reach or watershed for usability in decision
support models and other applications. Aggregating reach-scale
predictions across a river or watershed extent is more complicating than
adding up habitat values at a given flow, because instantaneous flows at
different points in the watershed differ. The delineation of reaches and
watersheds, as well as the aggregation process, are described in the <a href="watershed_aggregation.html">Watershed Aggregation</a>
article.</p></li>
</ol>
<p><img src="figures/flowchart.png" style="width:100.0%"></p>
</div>
<div class="section level2">
<h2 id="spawning-model-overview">Spawning Model Overview<a class="anchor" aria-label="anchor" href="#spawning-model-overview"></a>
</h2>
<p>The spawning model follows similar methods to the rearing model, with
the following distinctions.</p>
<ul>
<li><p><strong>Hydraulic model training data preparation</strong>: A
different depth- and velocity-based habitat suitability index is
applied. Additionally, while the baseflow channel is eliminated from the
hydraulic model result grid when assembling the rearing training data,
it is retained in the spawning training data.</p></li>
<li><p><strong>Training statistical model</strong>: The same methods are
used to train the statistical model, but feature selection and
validation yields a different set of predictor variables.</p></li>
<li><p><strong>Applying duration criteria</strong>: A different duration
suitability factor is applied to account for the extended minimum period
of continuous inundation required for spawning and incubation.</p></li>
<li><p><strong>Filtering to geographic scope</strong>: The spawning
model includes a more substantial filtering of reaches into those within
spawning range and likely to include spawning gravels. This analysis is
documented in the <a href="spawning_extents.html">Spawning Extents</a>
article. The core dataset is intended to capture overall suitability for
any run, so that it can be subsequently applied to a specific run based
on geographic scope filters and season-specific hydrology.</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="suitability-criteria">Suitability Criteria<a class="anchor" aria-label="anchor" href="#suitability-criteria"></a>
</h2>
<p>The following chart summarizes suitability criteria used in the
model. These are designed to be generally applicable criteria across the
Sacramento-San Joaquin basin, rather than tailored to individual stream
reaches. Currently, criteria are also generally applied to all runs of
Chinook salmon, but may be split out into different criteria for
different runs in the future. Application of the depth and velocity
criteria is described in the <a href="habitat_training_data.html">Habitat Training Data</a> article,
while application of the duration criteria is described in the <a href="duration_analysis.html">Duration Analysis</a> article.</p>
<p><img src="figures/model-overview-hsi_summary-1.png" width="2187.5"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Maddee Rubenson, <a href="mailto:slewis@flowwest.com">Skyler Lewis</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
